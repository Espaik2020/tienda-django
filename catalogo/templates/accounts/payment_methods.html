{% extends "base.html" %}
{% load static %}
{% block title_tag %}Métodos de pago{% endblock %}

{% block extra_css %}
<style>
  .acct-card{border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.04);border-radius:20px}
  .pm-card{
    border:1px solid rgba(255,255,255,.12);
    background:rgba(255,255,255,.03);
    border-radius:16px; padding:16px;
  }
  .pm-badge{border:1px solid rgba(255,255,255,.25); background:rgba(255,255,255,.08); color:#e8eef7; font-weight:700;}
  .empty{
    border:1px dashed rgba(255,255,255,.25); border-radius:16px; padding:28px; text-align:center; background:rgba(255,255,255,.03)
  }
  .empty i{font-size:48px; color:#fff; opacity:.9}
</style>
{% endblock %}

{% block content %}
<section class="section">
  <div class="container px-0">

    <div class="d-flex align-items-center justify-content-between mb-3">
      <h1 class="section-title h4 m-0">Métodos de pago</h1>
      <div class="d-flex gap-2">
        <a href="{% url 'cuenta_panel' %}" class="btn btn-outline-light btn-sm">Volver a mi cuenta</a>
        <a href="{% url 'producto_lista' %}" class="btn btn-primary btn-sm">Explorar productos</a>
      </div>
    </div>

    {% if messages %}
      <div class="mb-3">
        {% for m in messages %}
          <div class="alert alert-{{ m.tags|default:'info' }} py-2 mb-2">{{ m }}</div>
        {% endfor %}
      </div>
    {% endif %}

    {% if cards %}
      <div class="row g-3 mb-3">
        {% for c in cards %}
          <div class="col-12 col-md-6">
            <div class="pm-card h-100">
              <div class="d-flex align-items-center justify-content-between mb-1">
                <div class="fw-bold">{{ c.brand }}</div>
                {% if c.is_default %}
                  <span class="badge pm-badge">Predeterminado</span>
                {% endif %}
              </div>
              <div class="text-white-50 small mb-1">{{ c.holder }}</div>
              <div class="h5 m-0">**** **** **** {{ c.last4 }}</div>
              <div class="text-white-50 small mt-1">Vence: {{ c.exp }}</div>
              <div class="mt-3 d-flex gap-2">
                <button class="btn btn-outline-light btn-sm" disabled>Editar (simulado)</button>
                <button class="btn btn-outline-danger btn-sm" disabled>Eliminar (simulado)</button>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>

      <form method="post" class="acct-card p-3">
        {% csrf_token %}
        <input type="hidden" name="action" value="add_fake">
        <div class="row g-3 align-items-end">
          <div class="col-12 col-md-4">
            <label class="form-label">Titular</label>
            <input type="text" class="form-control" placeholder="Nombre en la tarjeta" disabled>
          </div>
          <div class="col-8 col-md-4">
            <label class="form-label">Número</label>
            <input type="text" class="form-control" placeholder="**** **** **** ****" disabled>
          </div>
          <div class="col-4 col-md-2">
            <label class="form-label">Exp.</label>
            <input type="text" class="form-control" placeholder="MM/AA" disabled>
          </div>
          <div class="col-12 col-md-2">
            <button class="btn btn-success w-100" type="submit">Agregar (demo)</button>
          </div>
        </div>
        <div class="form-text mt-2">
          Esta es una <strong>demostración</strong>. No se guardan datos reales ni se realiza ningún cobro.
        </div>
      </form>

    {% else %}
      <div class="empty">
        <div class="mb-2"><i class="bi bi-credit-card"></i></div>
        <h5 class="mb-1">Sin métodos de pago</h5>
        <p class="text-white-50 mb-3">Agrega un método (simulado) para completar tus compras más rápido.</p>
        <form method="post">
          {% csrf_token %}
          <input type="hidden" name="action" value="add_fake">
          <button class="btn btn-success fw-bold" type="submit">Agregar método (demo)</button>
        </form>
      </div>
    {% endif %}

  </div>
</section>
{% endblock %}
